<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Superman Content Hub</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary: #06b6d4;
            --primary-dark: #0891b2;
            --primary-light: #67e8f9;
            --sidebar-width: 240px;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }
        .sidebar {
            width: var(--sidebar-width);
            min-width: var(--sidebar-width);
        }
        .main-content {
            width: calc(100% - var(--sidebar-width));
        }
        .sidebar-link {
            border-left: 3px solid transparent;
        }
        .sidebar-link.active {
            border-left: 3px solid var(--primary);
            background-color: rgba(6, 182, 212, 0.1);
        }
        .sidebar-link:hover:not(.active) {
            border-left: 3px solid #e2e8f0;
            background-color: rgba(226, 232, 240, 0.3);
        }
        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        .lds-dual-ring {
            display: inline-block;
            width: 80px;
            height: 80px;
        }
        .lds-dual-ring:after {
            content: " ";
            display: block;
            width: 64px;
            height: 64px;
            margin: 8px;
            border-radius: 50%;
            border: 6px solid var(--primary);
            border-color: var(--primary) transparent var(--primary) transparent;
            animation: lds-dual-ring 1.2s linear infinite;
        }
        @keyframes lds-dual-ring {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex">
    <!-- Sidebar -->
    <aside class="sidebar bg-white shadow-md fixed h-full overflow-auto z-10">
        <div class="p-4 border-b border-gray-200">
            <h1 class="text-xl font-bold text-cyan-600">Superman Hub</h1>
        </div>
        <nav class="py-4">
            <div class="px-4 mb-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">Main</div>
            <a href="#" class="sidebar-link active flex items-center px-4 py-3 text-gray-700 hover:text-cyan-600">
                <i class="fas fa-layer-group w-6"></i>
                <span>Content</span>
            </a>
            <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-700 hover:text-cyan-600">
                <i class="fas fa-bolt w-6"></i>
                <span>Actions</span>
            </a>
            <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-700 hover:text-cyan-600">
                <i class="fas fa-calendar-alt w-6"></i>
                <span>Scheduled</span>
            </a>
            <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-700 hover:text-cyan-600">
                <i class="fas fa-globe w-6"></i>
                <span>Published</span>
            </a>
            
            <div class="px-4 mt-6 mb-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">Analytics</div>
            <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-700 hover:text-cyan-600">
                <i class="fas fa-chart-line w-6"></i>
                <span>Reports</span>
            </a>
            <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-700 hover:text-cyan-600">
                <i class="fas fa-chart-bar w-6"></i>
                <span>Performance</span>
            </a>
            
            <div class="px-4 mt-6 mb-2 text-xs font-semibold text-gray-500 uppercase tracking-wider">Settings</div>
            <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-700 hover:text-cyan-600">
                <i class="fas fa-cog w-6"></i>
                <span>Account</span>
            </a>
            <a href="#" class="sidebar-link flex items-center px-4 py-3 text-gray-700 hover:text-cyan-600">
                <i class="fas fa-user-friends w-6"></i>
                <span>Team</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content ml-60">
        <!-- Top Bar -->
        <header class="bg-white shadow-sm border-b border-gray-200 px-6 py-4 flex items-center justify-between sticky top-0 z-10">
            <div class="flex items-center">
                <h2 class="text-xl font-medium text-gray-800">Content Library</h2>
            </div>
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <input type="text" placeholder="Search content..." 
                           class="pl-10 pr-4 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                    <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
                </div>
                <button id="createContentBtn" class="px-4 py-2 rounded-md text-sm font-medium text-white bg-cyan-600 hover:bg-cyan-700">
                    Create Content
                </button>
            </div>
        </header>

        <!-- Content Area -->
        <div class="p-6">
            <!-- Tab Navigation -->
            <div class="mb-6 border-b border-gray-200">
                <nav class="flex space-x-8">
                    <button id="navContent" class="py-3 border-b-2 border-cyan-500 font-medium text-sm text-cyan-600">All Content</button>
                    <button id="navActions" class="py-3 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">Actions</button>
                    <button id="navScheduled" class="py-3 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">Scheduled</button>
                    <button id="navPublished" class="py-3 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">Published</button>
                </nav>
            </div>

            <!-- Filters -->
            <div class="mb-6 flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <select id="statusFilter" class="border border-gray-300 rounded-md p-2 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                        <option value="all">All Statuses</option>
                        <option value="In-Progress">In Progress</option>
                        <option value="Needs Review">Needs Review</option>
                        <option value="Approved">Approved</option>
                    </select>
                    <select class="border border-gray-300 rounded-md p-2 text-sm focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                        <option>Last 30 days</option>
                        <option>This month</option>
                        <option>Last month</option>
                        <option>Custom range</option>
                    </select>
                </div>
                <div class="flex items-center space-x-2">
                    <button class="p-2 rounded border border-gray-300 text-gray-500 hover:bg-gray-50">
                        <i class="fas fa-th-large"></i>
                    </button>
                    <button class="p-2 rounded border border-gray-300 text-gray-500 hover:bg-gray-50">
                        <i class="fas fa-list"></i>
                    </button>
                </div>
            </div>

            <!-- Loading spinner -->
            <div id="loadingSpinner" class="flex justify-center items-center h-64">
                <div class="lds-dual-ring"></div>
            </div>

            <!-- Error message -->
            <div id="errorMessage" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
                <span id="errorText" class="block sm:inline"></span>
            </div>

            <!-- Content Cards -->
            <div id="contentListing" class="hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="contentList">
                    <!-- Content cards will be inserted here dynamically -->
                </div>
            </div>

            <!-- Actions Grid -->
            <div id="actionsListing" class="hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="actionsList">
                    <!-- Action cards will be inserted here dynamically -->
                </div>
            </div>

            <!-- Scheduled Content -->
            <div id="scheduledContent" class="hidden">
                <!-- View toggles -->
                <div class="mb-4 flex justify-end">
                    <div class="inline-flex rounded-md shadow-sm" role="group">
                        <button type="button" id="listViewBtn" class="px-4 py-2 text-sm font-medium text-cyan-700 bg-white border border-cyan-200 rounded-l-lg hover:bg-cyan-50 focus:z-10 focus:ring-2 focus:ring-cyan-500">
                            <i class="fas fa-list mr-1"></i> List
                        </button>
                        <button type="button" id="calendarViewBtn" class="px-4 py-2 text-sm font-medium text-white bg-cyan-600 border border-cyan-600 rounded-r-lg hover:bg-cyan-700 focus:z-10 focus:ring-2 focus:ring-cyan-500">
                            <i class="fas fa-calendar-alt mr-1"></i> Calendar
                        </button>
                    </div>
                </div>
                
                <!-- List view -->
                <div id="scheduledListView" class="hidden">
                    <div class="grid grid-cols-1 gap-4" id="scheduledList">
                        <!-- Scheduled content items will be inserted here dynamically -->
                    </div>
                </div>
                
                <!-- Calendar view -->
                <div id="scheduledCalendarView" class="bg-white rounded-lg shadow p-4">
                    <div class="flex items-center justify-between mb-4">
                        <h2 class="text-xl font-semibold text-gray-800" id="currentMonthYear">April 2025</h2>
                        <div class="flex space-x-2">
                            <button id="prevMonth" class="p-2 rounded-md hover:bg-gray-100">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button id="nextMonth" class="p-2 rounded-md hover:bg-gray-100">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Calendar header -->
                    <div class="grid grid-cols-7 gap-1 mb-2">
                        <div class="text-center font-medium text-sm text-gray-500">Sun</div>
                        <div class="text-center font-medium text-sm text-gray-500">Mon</div>
                        <div class="text-center font-medium text-sm text-gray-500">Tue</div>
                        <div class="text-center font-medium text-sm text-gray-500">Wed</div>
                        <div class="text-center font-medium text-sm text-gray-500">Thu</div>
                        <div class="text-center font-medium text-sm text-gray-500">Fri</div>
                        <div class="text-center font-medium text-sm text-gray-500">Sat</div>
                    </div>
                    
                    <!-- Calendar grid -->
                    <div class="grid grid-cols-7 gap-1" id="calendarGrid">
                        <!-- Calendar days will be inserted here dynamically -->
                    </div>
                </div>
            </div>

            <!-- Published Content -->
            <div id="publishedContent" class="hidden">
                <div class="grid grid-cols-1 gap-4" id="publishedList">
                    <!-- Published content items will be inserted here dynamically -->
                </div>
            </div>
        </div>
    </main>

    <!-- Create/Edit Content Modal -->
    <div id="contentModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-6xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center border-b px-6 py-4">
                <h2 id="modalTitle" class="text-xl font-semibold text-gray-800">Create New Content</h2>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="flex">
                <!-- Left side: Content form -->
                <div class="p-6 w-2/3 border-r">
                    <form id="contentForm">
                        <input type="hidden" id="recordId">
                        <div class="mb-4">
                            <label for="title" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                            <input type="text" id="title" name="title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent" required>
                        </div>
                        <div class="mb-4">
                            <label for="description" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                            <input type="text" id="description" name="description" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent" required>
                        </div>
                        <div class="mb-4">
                            <label for="textContent" class="block text-sm font-medium text-gray-700 mb-1">Text Content</label>
                            <textarea id="textContent" name="textContent" rows="6" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent"></textarea>
                        </div>
                        <div class="mb-4">
                            <label for="textUrl" class="block text-sm font-medium text-gray-700 mb-1">Text Document URL (Google Docs)</label>
                            <input type="url" id="textUrl" name="textUrl" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                        </div>
                        <div class="mb-4">
                            <label for="folderUrl" class="block text-sm font-medium text-gray-700 mb-1">Folder URL (Google Drive)</label>
                            <input type="url" id="folderUrl" name="folderUrl" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                        </div>
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="publishDate" class="block text-sm font-medium text-gray-700 mb-1">Publish Date</label>
                                <input type="date" id="publishDate" name="publishDate" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                            </div>
                            <div>
                                <label for="textStatus" class="block text-sm font-medium text-gray-700 mb-1">Text Status</label>
                                <select id="textStatus" name="textStatus" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-transparent">
                                    <option value="In-Progress">In-Progress</option>
                                    <option value="Needs Review">Needs Review</option>
                                    <option value="Approved">Approved</option>
                                </select>
                            </div>
                        </div>

                        <!-- Social account selection -->
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Select social accounts</label>
                            <div class="border border-gray-300 rounded-md p-2">
                                <div class="flex items-center space-x-2">
                                    <input type="checkbox" id="facebookAccount" class="h-4 w-4 text-cyan-600 focus:ring-cyan-500 border-gray-300 rounded">
                                    <label for="facebookAccount" class="text-sm font-medium text-gray-700 flex items-center">
                                        <i class="fab fa-facebook text-blue-600 mr-1"></i> Superman Official
                                    </label>
                                </div>
                                <div class="flex items-center space-x-2 mt-2">
                                    <input type="checkbox" id="twitterAccount" class="h-4 w-4 text-cyan-600 focus:ring-cyan-500 border-gray-300 rounded">
                                    <label for="twitterAccount" class="text-sm font-medium text-gray-700 flex items-center">
                                        <i class="fab fa-twitter text-blue-400 mr-1"></i> @SupermanOfficial
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div class="mb-4">
                            <div class="flex items-center">
                                <input type="checkbox" id="schedule" name="schedule" class="h-4 w-4 text-cyan-600 focus:ring-cyan-500 border-gray-300 rounded">
                                <label for="schedule" class="ml-2 text-sm font-medium text-gray-700">Schedule for Publishing</label>
                            </div>
                        </div>
                        <div class="flex justify-end space-x-3">
                            <button type="button" id="cancelButton" class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
                                Cancel
                            </button>
                            <button type="submit" id="saveButton" class="px-4 py-2 bg-cyan-600 text-white rounded-md text-sm font-medium hover:bg-cyan-700">
                                Save Content
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Right side: Post preview -->
                <div class="w-1/3 p-6 bg-gray-50">
                    <div class="border-b pb-3 mb-4">
                        <h3 class="text-lg font-medium text-gray-800">Post preview</h3>
                        <div class="flex items-center mt-2">
                            <div class="relative">
                                <button id="previewPlatformSelector" class="flex items-center space-x-2 px-3 py-1 border border-gray-300 rounded-md text-sm">
                                    <i class="fab fa-facebook text-blue-600"></i>
                                    <span>Facebook preview</span>
                                    <i class="fas fa-chevron-down ml-2 text-gray-400"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Facebook Preview -->
                    <div id="facebookPreview" class="bg-white border border-gray-300 rounded-lg shadow-sm">
                        <div class="p-3">
                            <div class="flex items-center">
                                <div class="w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <div class="ml-2">
                                    <div class="font-medium">Superman Official</div>
                                    <div class="text-xs text-gray-500">Today • Just now</div>
                                </div>
                            </div>
                            <div class="mt-2 preview-content text-sm" id="previewContent">
                                Your post content will appear here...
                            </div>
                            <div class="mt-2">
                                <div class="bg-gray-200 h-60 rounded flex items-center justify-center text-gray-400">
                                    <i class="fas fa-image text-3xl"></i>
                                </div>
                            </div>
                        </div>
                        <div class="border-t border-gray-200 p-2">
                            <div class="flex justify-between text-sm text-gray-500">
                                <button class="flex items-center px-2 py-1 hover:bg-gray-100 rounded">
                                    <i class="far fa-thumbs-up mr-1"></i> Like
                                </button>
                                <button class="flex items-center px-2 py-1 hover:bg-gray-100 rounded">
                                    <i class="far fa-comment mr-1"></i> Comment
                                </button>
                                <button class="flex items-center px-2 py-1 hover:bg-gray-100 rounded">
                                    <i class="far fa-share-square mr-1"></i> Share
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- View Content Detail Modal -->
    <div id="detailModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg shadow-xl max-w-5xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center border-b px-6 py-4">
                <h2 id="detailTitle" class="text-xl font-semibold text-gray-800">Content Details</h2>
                <button id="closeDetailModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="flex flex-col md:flex-row">
                <!-- Left column: Content preview -->
                <div class="md:w-1/2 p-6 border-r border-gray-200">
                    <!-- Social media preview card -->
                    <div class="bg-white border border-gray-300 rounded-lg shadow mb-6">
                        <div class="p-4 border-b border-gray-200">
                            <div class="flex items-center">
                                <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white">
                                    <i class="fas fa-shield-alt text-xl"></i>
                                </div>
                                <div class="ml-3">
                                    <div class="font-bold text-gray-900">Superman Official</div>
                                    <div class="text-xs text-gray-500 flex items-center">
                                        <span id="previewPublishDate">April 16, 2025</span> • 
                                        <i class="fas fa-globe-americas ml-1 mr-1"></i> <span>Public</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="mt-3" id="previewContentText">
                                <!-- Content text will be inserted here -->
                            </div>
                            
                            <div class="mt-3 rounded-lg overflow-hidden bg-gray-100" id="previewMediaContainer">
                                <!-- Media will be inserted here if available -->
                            </div>
                        </div>
                        
                        <div class="px-4 py-2 border-b border-gray-200">
                            <div class="flex items-center text-gray-500 text-sm">
                                <div class="flex items-center mr-4">
                                    <i class="far fa-thumbs-up mr-1"></i> <span>0</span>
                                </div>
                                <div class="flex items-center">
                                    <i class="far fa-comment mr-1"></i> <span>0 comments</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex px-2 py-2">
                            <button class="flex-1 flex items-center justify-center py-2 hover:bg-gray-100 rounded text-gray-600">
                                <i class="far fa-thumbs-up mr-2"></i> Like
                            </button>
                            <button class="flex-1 flex items-center justify-center py-2 hover:bg-gray-100 rounded text-gray-600">
                                <i class="far fa-comment mr-2"></i> Comment
                            </button>
                            <button class="flex-1 flex items-center justify-center py-2 hover:bg-gray-100 rounded text-gray-600">
                                <i class="far fa-share-square mr-2"></i> Share
                            </button>
                        </div>
                    </div>
                    
                    <!-- Platform selection -->
                    <div class="mt-4 mb-6">
                        <h3 class="text-sm font-medium text-gray-500 mb-2">VIEW AS</h3>
                        <div class="flex space-x-2">
                            <button class="flex items-center space-x-1 px-3 py-2 bg-blue-100 text-blue-800 rounded-md">
                                <i class="fab fa-facebook text-blue-600"></i>
                                <span>Facebook</span>
                            </button>
                            <button class="flex items-center space-x-1 px-3 py-2 bg-gray-100 text-gray-800 rounded-md">
                                <i class="fab fa-twitter text-blue-400"></i>
                                <span>Twitter</span>
                            </button>
                            <button class="flex items-center space-x-1 px-3 py-2 bg-gray-100 text-gray-800 rounded-md">
                                <i class="fab fa-instagram text-pink-600"></i>
                                <span>Instagram</span>
                            </button>
                        </div>
                    </div>
                    
                    <!-- External links -->
                    <div id="externalLinksContainer">
                        <!-- External links will be inserted here -->
                    </div>
                </div>
                
                <!-- Right column: Content details and actions -->
                <div class="md:w-1/2 p-6">
                    <div class="mb-6">
                        <div class="flex flex-wrap gap-2 mb-4" id="statusBadgesContainer">
                            <!-- Status badges will be inserted here -->
                        </div>
                        
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div class="bg-gray-50 p-3 rounded-md border border-gray-200">
                                <p class="text-xs font-medium text-gray-500">CONTENT ID</p>
                                <p id="detailContentId" class="mt-1 font-medium"></p>
                            </div>
                            <div class="bg-gray-50 p-3 rounded-md border border-gray-200">
                                <p class="text-xs font-medium text-gray-500">CREATED</p>
                                <p id="detailCreatedDate" class="mt-1"></p>
                            </div>
                            <div class="bg-gray-50 p-3 rounded-md border border-gray-200">
                                <p class="text-xs font-medium text-gray-500">LAST MODIFIED</p>
                                <p id="detailModifiedDate" class="mt-1"></p>
                            </div>
                            <div class="bg-gray-50 p-3 rounded-md border border-gray-200">
                                <p class="text-xs font-medium text-gray-500">PUBLISH DATE</p>
                                <p id="detailPublishDate" class="mt-1"></p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Description -->
                    <div class="mb-6">
                        <h3 class="text-sm font-medium text-gray-500 mb-2">DESCRIPTION</h3>
                        <div id="detailDescription" class="bg-gray-50 p-3 rounded-md border border-gray-200"></div>
                    </div>
                    
                    <!-- Actions section -->
                    <div class="mt-6">
                        <h3 class="text-sm font-medium text-gray-500 mb-3">ACTIONS</h3>
                        <div class="bg-gray-50 p-4 rounded-md border border-gray-200">
                            <div class="grid grid-cols-2 gap-3" id="actionButtons">
                                <!-- Action buttons will be inserted here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Buttons -->
                    <div class="flex justify-between mt-6">
                        <button id="editContentBtn" class="px-4 py-2 bg-cyan-600 text-white rounded-md text-sm font-medium hover:bg-cyan-700 flex items-center">
                            <i class="fas fa-edit mr-2"></i> Edit Content
                        </button>
                        <button id="publishContentBtn" class="px-4 py-2 bg-emerald-600 text-white rounded-md text-sm font-medium hover:bg-emerald-700 flex items-center">
                            <i class="fas fa-paper-plane mr-2"></i> Publish Now
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Airtable configuration
        const AIRTABLE_BASE_ID = 'app6js5HlKSJaPs9J';
        const AIRTABLE_API_KEY = 'patWIccg6g6M6RUeN.3335205e114ef1f17aec15b16ca10146602f2b01d240da007e8cc4bf89a4937e';
        const CONTENT_TABLE_ID = 'tblMImhEcmQPpdWtz';
        const ACTIONS_TABLE_ID = 'tblt0hrAShIrkVWz6';

        // Main data storage
        let contentItems = [];
        let actionItems = [];
        let currentView = 'content';
        let selectedContentId = null;

        // DOM Elements
        const loadingSpinner = document.getElementById('loadingSpinner');
        const errorMessage = document.getElementById('errorMessage');
        const errorText = document.getElementById('errorText');
        const contentListing = document.getElementById('contentListing');
        const actionsListing = document.getElementById('actionsListing');
        const scheduledContent = document.getElementById('scheduledContent');
        const publishedContent = document.getElementById('publishedContent');
        const contentList = document.getElementById('contentList');
        const actionsList = document.getElementById('actionsList');
        const scheduledList = document.getElementById('scheduledList');
        const publishedList = document.getElementById('publishedList');
        const statusFilter = document.getElementById('statusFilter');
        const searchInput = document.querySelector('input[placeholder="Search content..."]');
        const contentModal = document.getElementById('contentModal');
        const detailModal = document.getElementById('detailModal');
        const contentForm = document.getElementById('contentForm');

        // Nav buttons
        document.getElementById('navContent').addEventListener('click', () => switchView('content'));
        document.getElementById('navActions').addEventListener('click', () => switchView('actions'));
        document.getElementById('navScheduled').addEventListener('click', () => switchView('scheduled'));
        document.getElementById('navPublished').addEventListener('click', () => switchView('published'));

        // Modal controls
        document.getElementById('createContentBtn').addEventListener('click', openCreateContentModal);
        document.getElementById('closeModal').addEventListener('click', closeContentModal);
        document.getElementById('cancelButton').addEventListener('click', closeContentModal);
        document.getElementById('closeDetailModal').addEventListener('click', closeDetailModal);
        document.getElementById('contentForm').addEventListener('submit', handleSaveContent);
        document.getElementById('editContentBtn').addEventListener('click', handleEditContent);
        document.getElementById('publishContentBtn').addEventListener('click', handlePublishContent);

        // Filter controls
        statusFilter.addEventListener('change', filterContent);
        searchInput.addEventListener('input', filterContent);

        // API Functions
        async function fetchContentItems() {
            showLoading();
            try {
                const response = await fetch(`https://api.airtable.com/v0/${AIRTABLE_BASE_ID}/${CONTENT_TABLE_ID}?maxRecords=100`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${AIRTABLE_API_KEY}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error('Failed to fetch content items');
                }
                
                const data = await response.json();
                contentItems = data.records;
                renderContent();
            } catch (error) {
                showError(error.message);
            } finally {
                hideLoading();
            }
        }

        async function fetchActionItems() {
            showLoading();
            try {
                const response = await fetch(`https://api.airtable.com/v0/${AIRTABLE_BASE_ID}/${ACTIONS_TABLE_ID}?maxRecords=100`, {
                    method: 'GET',
                    headers: {
                        'Authorization': `Bearer ${AIRTABLE_API_KEY}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error('Failed to fetch action items');
                }
                
                const data = await response.json();
                actionItems = data.records;
                renderActions();
            } catch (error) {
                showError(error.message);
            } finally {
                hideLoading();
            }
        }

        async function createContentItem(fields) {
            showLoading();
            try {
                const response = await fetch(`https://api.airtable.com/v0/${AIRTABLE_BASE_ID}/${CONTENT_TABLE_ID}`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${AIRTABLE_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ fields })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to create content item');
                }
                
                await fetchContentItems();
                return response.json();
            } catch (error) {
                showError(error.message);
                throw error;
            } finally {
                hideLoading();
            }
        }

        async function updateContentItem(id, fields) {
            showLoading();
            try {
                const response = await fetch(`https://api.airtable.com/v0/${AIRTABLE_BASE_ID}/${CONTENT_TABLE_ID}/${id}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `Bearer ${AIRTABLE_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ fields })
                });
                
                if (!response.ok) {
                    throw new Error('Failed to update content item');
                }
                
                await fetchContentItems();
                return response.json();
            } catch (error) {
                showError(error.message);
                throw error;
            } finally {
                hideLoading();
            }
        }

        async function triggerAction(contentId, actionId) {
            showLoading();
            try {
                const action = actionItems.find(item => item.id === actionId);
                if (!action || !action.fields['Webhook URL']) {
                    throw new Error('Action webhook URL not found');
                }

                // Create a link between content and action
                await fetch(`https://api.airtable.com/v0/${AIRTABLE_BASE_ID}/${CONTENT_TABLE_ID}/${contentId}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `Bearer ${AIRTABLE_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        fields: {
                            'Action': [actionId]
                        }
                    })
                });

                // Call the webhook
                const webhookUrl = action.fields['Webhook URL'];
                await fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ 
                        contentId,
                        actionId 
                    })
                });
                
                // Show success notification
                showNotification(`Action "${action.fields['Action Name']}" triggered successfully!`, 'success');
                await fetchContentItems();
            } catch (error) {
                showError(`Failed to trigger action: ${error.message}`);
            } finally {
                hideLoading();
            }
        }
        
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            
            // Set classes based on type
            let bgColor, iconClass;
            switch (type) {
                case 'success':
                    bgColor = 'bg-green-50 border-green-400 text-green-800';
                    iconClass = 'fas fa-check-circle text-green-400';
                    break;
                case 'error':
                    bgColor = 'bg-red-50 border-red-400 text-red-800';
                    iconClass = 'fas fa-exclamation-circle text-red-400';
                    break;
                case 'warning':
                    bgColor = 'bg-yellow-50 border-yellow-400 text-yellow-800';
                    iconClass = 'fas fa-exclamation-triangle text-yellow-400';
                    break;
                default:
                    bgColor = 'bg-blue-50 border-blue-400 text-blue-800';
                    iconClass = 'fas fa-info-circle text-blue-400';
            }
            
            notification.className = `fixed bottom-4 right-4 flex items-center p-4 border-l-4 rounded shadow-md ${bgColor} transform transition-all duration-500 translate-y-20 opacity-0`;
            
            notification.innerHTML = `
                <div class="mr-3">
                    <i class="${iconClass} text-xl"></i>
                </div>
                <div>
                    <p class="font-medium">${message}</p>
                </div>
                <button class="ml-6 text-gray-400 hover:text-gray-600">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            // Add to document
            document.body.appendChild(notification);
            
            // Add event listener to close button
            notification.querySelector('button').addEventListener('click', () => {
                notification.classList.add('opacity-0', 'translate-y-20');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 500);
            });
            
            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-y-20', 'opacity-0');
            }, 10);
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (document.body.contains(notification)) {
                    notification.classList.add('opacity-0', 'translate-y-20');
                    setTimeout(() => {
                        if (document.body.contains(notification)) {
                            document.body.removeChild(notification);
                        }
                    }, 500);
                }
            }, 5000);
        }

        // UI Rendering Functions
        function renderContent() {
            contentList.innerHTML = '';
            
            const filteredItems = filterContentItems();
            
            if (filteredItems.length === 0) {
                contentList.innerHTML = `
                    <div class="col-span-full text-center py-12 text-gray-500">
                        No content items found
                    </div>
                `;
                return;
            }
            
            filteredItems.forEach(item => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow duration-200';
                card.dataset.id = item.id;
                
                const statusColor = getStatusColor(item.fields['Text Status'] || 'In-Progress');
                const hasSchedule = item.fields['Schedule'] === true;
                const isPublished = item.fields['Published'] === true;
                
                card.innerHTML = `
                    <div class="p-4">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-medium text-gray-900 truncate">${item.fields['Title'] || 'Untitled'}</h3>
                            <div class="flex space-x-1">
                                <span class="w-2 h-2 rounded-full ${statusColor.bg}"></span>
                            </div>
                        </div>
                        <p class="text-sm text-gray-500 mb-4 line-clamp-2">${item.fields['Description'] || 'No description'}</p>
                        
                        <div class="flex items-center text-xs text-gray-500 mb-3">
                            <i class="fas fa-clock mr-1"></i>
                            <span>${item.fields['Created'] ? new Date(item.fields['Created']).toLocaleDateString() : 'No date'}</span>
                        </div>
                        
                        <div class="flex flex-wrap gap-2">
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${statusColor.text} ${statusColor.bg}">
                                ${item.fields['Text Status'] || 'No Status'}
                            </span>
                            ${hasSchedule ? `
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                    <i class="fas fa-calendar-alt mr-1"></i> Scheduled
                                </span>
                            ` : ''}
                            ${isPublished ? `
                                <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                    <i class="fas fa-check-circle mr-1"></i> Published
                                </span>
                            ` : ''}
                        </div>
                    </div>
                    <div class="border-t border-gray-200 bg-gray-50 px-4 py-3 flex justify-between items-center">
                        <span class="text-xs text-gray-500">ID: ${item.fields['Content ID'] || item.id.slice(0, 8)}</span>
                        <button class="p-1 text-cyan-600 hover:text-cyan-800 rounded">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                `;
                
                card.addEventListener('click', () => openContentDetail(item.id));
                contentList.appendChild(card);
            });
        }
        
        // Update preview in the content form
        document.addEventListener('DOMContentLoaded', function() {
            const textContentField = document.getElementById('textContent');
            const titleField = document.getElementById('title');
            const previewContent = document.getElementById('previewContent');
            
            // Update preview when text content changes
            if (textContentField) {
                textContentField.addEventListener('input', function() {
                    previewContent.textContent = this.value || 'Your post content will appear here...';
                });
            }
            
            // Update preview when title changes (as fallback)
            if (titleField) {
                titleField.addEventListener('input', function() {
                    if (!textContentField.value) {
                        previewContent.textContent = this.value || 'Your post content will appear here...';
                    }
                });
            }
        });

        function renderActions() {
            actionsList.innerHTML = '';
            
            if (actionItems.length === 0) {
                actionsList.innerHTML = `
                    <div class="col-span-full text-center py-12 text-gray-500">
                        No actions found
                    </div>
                `;
                return;
            }
            
            actionItems.forEach(item => {
                if (!(item.fields['Active'] === true)) return;
                
                const card = document.createElement('div');
                card.className = 'bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow duration-200';
                
                card.innerHTML = `
                    <div class="p-4">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-medium text-gray-900">${item.fields['Action Name']}</h3>
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                Active
                            </span>
                        </div>
                        <p class="text-sm text-gray-500 mb-4">${item.fields['Notes'] || 'No description'}</p>
                        
                        <div class="flex flex-wrap gap-2">
                            ${item.fields['Webhook URL'] ? `
                                <div class="text-xs text-gray-500">
                                    <i class="fas fa-link mr-1"></i> Webhook configured
                                </div>
                            ` : ''}
                        </div>
                    </div>
                    <div class="border-t border-gray-200 bg-gray-50 px-4 py-3 flex justify-end">
                        <button class="px-3 py-1 bg-cyan-100 text-cyan-700 rounded text-xs font-medium hover:bg-cyan-200">
                            Use Action
                        </button>
                    </div>
                `;
                
                actionsList.appendChild(card);
            });
        }

        // Calendar view handling
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();
        
        function renderScheduledContent() {
            const listView = document.getElementById('scheduledListView');
            const calendarView = document.getElementById('scheduledCalendarView');
            const listViewBtn = document.getElementById('listViewBtn');
            const calendarViewBtn = document.getElementById('calendarViewBtn');
            
            // Set up view toggle buttons
            listViewBtn.addEventListener('click', () => {
                listView.classList.remove('hidden');
                calendarView.classList.add('hidden');
                listViewBtn.classList.add('bg-cyan-600', 'text-white');
                listViewBtn.classList.remove('bg-white', 'text-cyan-700');
                calendarViewBtn.classList.add('bg-white', 'text-cyan-700');
                calendarViewBtn.classList.remove('bg-cyan-600', 'text-white');
            });
            
            calendarViewBtn.addEventListener('click', () => {
                calendarView.classList.remove('hidden');
                listView.classList.add('hidden');
                calendarViewBtn.classList.add('bg-cyan-600', 'text-white');
                calendarViewBtn.classList.remove('bg-white', 'text-cyan-700');
                listViewBtn.classList.add('bg-white', 'text-cyan-700');
                listViewBtn.classList.remove('bg-cyan-600', 'text-white');
            });
            
            // Set up month navigation
            document.getElementById('prevMonth').addEventListener('click', () => {
                currentMonth--;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                }
                renderCalendar();
            });
            
            document.getElementById('nextMonth').addEventListener('click', () => {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                renderCalendar();
            });
            
            renderScheduledList();
            renderCalendar();
            
            // Show calendar view by default
            calendarView.classList.remove('hidden');
            listView.classList.add('hidden');
        }
        
        function renderScheduledList() {
            const scheduledList = document.getElementById('scheduledList');
            scheduledList.innerHTML = '';
            
            const scheduledItems = contentItems.filter(item => item.fields['Schedule'] === true && item.fields['Published'] !== true);
            
            if (scheduledItems.length === 0) {
                scheduledList.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        No scheduled content found
                    </div>
                `;
                return;
            }
            
            // Sort by publish date (earliest first)
            scheduledItems.sort((a, b) => {
                const dateA = a.fields['Publish Date'] ? new Date(a.fields['Publish Date']) : new Date(9999, 11, 31);
                const dateB = b.fields['Publish Date'] ? new Date(b.fields['Publish Date']) : new Date(9999, 11, 31);
                return dateA - dateB;
            });
            
            scheduledItems.forEach(item => {
                const itemCard = document.createElement('div');
                itemCard.className = 'bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow duration-200 flex';
                itemCard.dataset.id = item.id;
                
                const statusColor = getStatusColor(item.fields['Text Status'] || 'In-Progress');
                const publishDate = item.fields['Publish Date'] ? new Date(item.fields['Publish Date']) : null;
                
                itemCard.innerHTML = `
                    <div class="bg-blue-50 border-r border-blue-100 p-3 flex flex-col items-center justify-center text-blue-700 w-24">
                        ${publishDate ? `
                            <div class="text-xl font-bold">${publishDate.getDate()}</div>
                            <div class="text-sm">${publishDate.toLocaleString('default', { month: 'short' })}</div>
                            <div class="text-xs">${publishDate.getFullYear()}</div>
                        ` : `
                            <i class="fas fa-calendar-alt text-2xl"></i>
                            <div class="text-xs mt-1">No date</div>
                        `}
                    </div>
                    <div class="p-4 flex-grow">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-medium text-gray-900">${item.fields['Title'] || 'Untitled'}</h3>
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${statusColor.text} ${statusColor.bg}">
                                ${item.fields['Text Status'] || 'No Status'}
                            </span>
                        </div>
                        <p class="text-sm text-gray-500">${item.fields['Description'] || 'No description'}</p>
                    </div>
                    <div class="p-4 flex items-center">
                        <button class="p-2 text-cyan-600 hover:text-cyan-800 hover:bg-cyan-50 rounded">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                `;
                
                itemCard.addEventListener('click', () => openContentDetail(item.id));
                scheduledList.appendChild(itemCard);
            });
        }
        
        function renderCalendar() {
            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            const calendarGrid = document.getElementById('calendarGrid');
            const monthYearLabel = document.getElementById('currentMonthYear');
            
            // Update month/year display
            monthYearLabel.textContent = `${monthNames[currentMonth]} ${currentYear}`;
            
            // Clear the calendar
            calendarGrid.innerHTML = '';
            
            // Get the first day of the month
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            
            // Get the number of days in the month
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            // Get all scheduled content items
            const scheduledItems = contentItems.filter(item => {
                if (item.fields['Schedule'] !== true || item.fields['Published'] === true) return false;
                if (!item.fields['Publish Date']) return false;
                
                const publishDate = new Date(item.fields['Publish Date']);
                return publishDate.getMonth() === currentMonth && publishDate.getFullYear() === currentYear;
            });
            
            // Create calendar days
            // Add empty cells for days before the first day of the month
            for (let i = 0; i < firstDay; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'h-24 bg-gray-50 rounded p-1';
                calendarGrid.appendChild(emptyCell);
            }
            
            // Add cells for each day of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayCell = document.createElement('div');
                dayCell.className = 'min-h-24 bg-white border border-gray-200 rounded p-1 overflow-hidden';
                
                // Check if it's today
                const isToday = day === new Date().getDate() && 
                                currentMonth === new Date().getMonth() && 
                                currentYear === new Date().getFullYear();
                
                if (isToday) {
                    dayCell.classList.add('ring-2', 'ring-cyan-500');
                }
                
                // Add the day number
                const dayHeader = document.createElement('div');
                dayHeader.className = `text-right text-sm font-medium ${isToday ? 'text-cyan-600' : 'text-gray-500'}`;
                dayHeader.textContent = day;
                dayCell.appendChild(dayHeader);
                
                // Add content for this day
                const dayItems = scheduledItems.filter(item => {
                    const publishDate = new Date(item.fields['Publish Date']);
                    return publishDate.getDate() === day;
                });
                
                dayItems.forEach(item => {
                    const itemEl = document.createElement('div');
                    itemEl.className = 'mt-1 p-1 text-xs bg-cyan-50 border-l-2 border-cyan-500 rounded truncate cursor-pointer hover:bg-cyan-100';
                    itemEl.textContent = item.fields['Title'] || 'Untitled';
                    itemEl.dataset.id = item.id;
                    itemEl.addEventListener('click', () => openContentDetail(item.id));
                    dayCell.appendChild(itemEl);
                });
                
                calendarGrid.appendChild(dayCell);
            }
        }

        function renderPublishedContent() {
            publishedList.innerHTML = '';
            
            const publishedItems = contentItems.filter(item => item.fields['Published'] === true);
            
            if (publishedItems.length === 0) {
                publishedList.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        No published content found
                    </div>
                `;
                return;
            }
            
            // Sort by publish date (most recent first)
            publishedItems.sort((a, b) => {
                const dateA = a.fields['Publish Date'] ? new Date(a.fields['Publish Date']) : new Date(0);
                const dateB = b.fields['Publish Date'] ? new Date(b.fields['Publish Date']) : new Date(0);
                return dateB - dateA;
            });
            
            publishedItems.forEach(item => {
                const itemCard = document.createElement('div');
                itemCard.className = 'bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden hover:shadow-md transition-shadow duration-200 flex';
                itemCard.dataset.id = item.id;
                
                const publishDate = item.fields['Publish Date'] ? new Date(item.fields['Publish Date']) : null;
                
                itemCard.innerHTML = `
                    <div class="bg-green-50 border-r border-green-100 p-3 flex flex-col items-center justify-center text-green-700 w-24">
                        ${publishDate ? `
                            <div class="text-xl font-bold">${publishDate.getDate()}</div>
                            <div class="text-sm">${publishDate.toLocaleString('default', { month: 'short' })}</div>
                            <div class="text-xs">${publishDate.getFullYear()}</div>
                        ` : `
                            <i class="fas fa-check-circle text-2xl"></i>
                            <div class="text-xs mt-1">Published</div>
                        `}
                    </div>
                    <div class="p-4 flex-grow">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-medium text-gray-900">${item.fields['Title'] || 'Untitled'}</h3>
                            <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                Published
                            </span>
                        </div>
                        <p class="text-sm text-gray-500">${item.fields['Description'] || 'No description'}</p>
                        
                        ${item.fields['Publish URL'] ? `
                            <div class="mt-3">
                                <a href="${item.fields['Publish URL']}" target="_blank" class="text-xs text-cyan-600 hover:text-cyan-800 flex items-center">
                                    <i class="fas fa-external-link-alt mr-1"></i> View Published
                                </a>
                            </div>
                        ` : ''}
                    </div>
                    <div class="p-4 flex items-center">
                        <button class="p-2 text-cyan-600 hover:text-cyan-800 hover:bg-cyan-50 rounded">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                `;
                
                itemCard.addEventListener('click', () => openContentDetail(item.id));
                publishedList.appendChild(itemCard);
            });
        }

        function renderContentDetail(id) {
            const content = contentItems.find(item => item.id === id);
            if (!content) return;
            
            document.getElementById('detailTitle').textContent = content.fields['Title'] || 'Content Details';
            
            // Update status badges
            const statusBadgesContainer = document.getElementById('statusBadgesContainer');
            statusBadgesContainer.innerHTML = '';
            
            if (content.fields['Text Status']) {
                const statusColor = getStatusColor(content.fields['Text Status']);
                const badge = document.createElement('span');
                badge.className = `inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusColor.text} ${statusColor.bg}`;
                badge.textContent = content.fields['Text Status'];
                statusBadgesContainer.appendChild(badge);
            }
            
            if (content.fields['Schedule'] === true) {
                const badge = document.createElement('span');
                badge.className = 'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800';
                badge.innerHTML = '<i class="fas fa-calendar-alt mr-1"></i> Scheduled';
                statusBadgesContainer.appendChild(badge);
            }
            
            if (content.fields['Published'] === true) {
                const badge = document.createElement('span');
                badge.className = 'inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800';
                badge.innerHTML = '<i class="fas fa-check-circle mr-1"></i> Published';
                statusBadgesContainer.appendChild(badge);
            }
            
            // Update preview content
            const previewContentText = document.getElementById('previewContentText');
            previewContentText.innerHTML = '';
            
            // Add title as heading
            const titleElement = document.createElement('h3');
            titleElement.className = 'text-lg font-medium text-gray-900 mb-2';
            titleElement.textContent = content.fields['Title'] || 'Untitled';
            previewContentText.appendChild(titleElement);
            
            // Add text content
            if (content.fields['Text']) {
                const textElement = document.createElement('p');
                textElement.className = 'text-gray-700';
                textElement.innerHTML = content.fields['Text'].replace(/\n/g, '<br>');
                previewContentText.appendChild(textElement);
            } else if (content.fields['Description']) {
                const textElement = document.createElement('p');
                textElement.className = 'text-gray-700';
                textElement.textContent = content.fields['Description'];
                previewContentText.appendChild(textElement);
            }
            
            // Update publish date in preview
            const previewPublishDate = document.getElementById('previewPublishDate');
            if (content.fields['Publish Date']) {
                previewPublishDate.textContent = new Date(content.fields['Publish Date']).toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            } else {
                previewPublishDate.textContent = new Date().toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            }
            
            // Update media preview
            const previewMediaContainer = document.getElementById('previewMediaContainer');
            previewMediaContainer.innerHTML = '';
            
            if (content.fields['Image'] && content.fields['Image'].length > 0) {
                const img = document.createElement('img');
                img.src = content.fields['Image'][0].url;
                img.alt = 'Content image';
                img.className = 'w-full h-auto';
                previewMediaContainer.appendChild(img);
            } else {
                previewMediaContainer.innerHTML = `
                    <div class="flex items-center justify-center h-48 bg-gray-200 text-gray-400">
                        <i class="fas fa-image text-4xl"></i>
                    </div>
                `;
            }
            
            // Update content details
            document.getElementById('detailContentId').textContent = content.fields['Content ID'] || 'N/A';
            document.getElementById('detailCreatedDate').textContent = content.fields['Created'] ? 
                new Date(content.fields['Created']).toLocaleString() : 'N/A';
            document.getElementById('detailModifiedDate').textContent = content.fields['Last Modified'] ? 
                new Date(content.fields['Last Modified']).toLocaleString() : 'N/A';
            document.getElementById('detailPublishDate').textContent = content.fields['Publish Date'] ? 
                new Date(content.fields['Publish Date']).toLocaleDateString() : 'Not set';
            document.getElementById('detailDescription').textContent = content.fields['Description'] || 'No description';
            
            // Update external links
            const externalLinksContainer = document.getElementById('externalLinksContainer');
            externalLinksContainer.innerHTML = '';
            
            const hasExternalLinks = content.fields['Text URL'] || content.fields['Folder URL'] || content.fields['Publish URL'];
            
            if (hasExternalLinks) {
                externalLinksContainer.innerHTML = `
                    <h3 class="text-sm font-medium text-gray-500 mb-2">EXTERNAL LINKS</h3>
                    <div class="space-y-2">
                        ${content.fields['Text URL'] ? `
                            <a href="${content.fields['Text URL']}" target="_blank" 
                               class="flex items-center p-3 bg-gray-50 rounded-md border border-gray-200 text-cyan-600 hover:bg-gray-100">
                                <i class="fas fa-file-alt mr-2"></i>
                                <span>Open Text Document</span>
                                <i class="fas fa-external-link-alt ml-auto"></i>
                            </a>
                        ` : ''}
                        ${content.fields['Folder URL'] ? `
                            <a href="${content.fields['Folder URL']}" target="_blank" 
                               class="flex items-center p-3 bg-gray-50 rounded-md border border-gray-200 text-cyan-600 hover:bg-gray-100">
                                <i class="fas fa-folder-open mr-2"></i>
                                <span>Open Google Drive Folder</span>
                                <i class="fas fa-external-link-alt ml-auto"></i>
                            </a>
                        ` : ''}
                        ${content.fields['Publish URL'] ? `
                            <a href="${content.fields['Publish URL']}" target="_blank" 
                               class="flex items-center p-3 bg-gray-50 rounded-md border border-gray-200 text-green-600 hover:bg-gray-100">
                                <i class="fas fa-globe mr-2"></i>
                                <span>View Published Content</span>
                                <i class="fas fa-external-link-alt ml-auto"></i>
                            </a>
                        ` : ''}
                    </div>
                `;
            }
            
            // Action buttons
            const actionButtons = document.getElementById('actionButtons');
            actionButtons.innerHTML = '';
            
            actionItems.forEach(action => {
                if (action.fields['Active'] !== true) return;
                
                const button = document.createElement('button');
                button.className = 'flex items-center justify-center p-3 bg-white border border-gray-200 rounded-md text-cyan-700 hover:bg-cyan-50 transition duration-150';
                button.innerHTML = `
                    <div class="flex flex-col items-center">
                        <i class="fas ${getActionIcon(action.fields['Action Name'])} text-xl mb-1"></i>
                        <span class="text-xs font-medium">${action.fields['Action Name']}</span>
                    </div>
                `;
                
                button.addEventListener('click', () => showActionConfirmation(content.id, action));
                actionButtons.appendChild(button);
            });
            
            // Update publish button state
            const publishBtn = document.getElementById('publishContentBtn');
            if (content.fields['Published'] === true) {
                publishBtn.innerHTML = '<i class="fas fa-check-circle mr-2"></i> Already Published';
                publishBtn.disabled = true;
                publishBtn.classList.remove('bg-emerald-600', 'hover:bg-emerald-700');
                publishBtn.classList.add('bg-gray-300', 'cursor-not-allowed');
            } else {
                publishBtn.innerHTML = '<i class="fas fa-paper-plane mr-2"></i> Publish Now';
                publishBtn.disabled = false;
                publishBtn.classList.remove('bg-gray-300', 'cursor-not-allowed');
                publishBtn.classList.add('bg-emerald-600', 'hover:bg-emerald-700');
            }
        }
        
        function showActionConfirmation(contentId, action) {
            // Create modal for action confirmation
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-50';
            
            modal.innerHTML = `
                <div class="bg-white rounded-lg shadow-xl max-w-md w-full mx-4 overflow-hidden">
                    <div class="p-6 text-center">
                        <div class="w-16 h-16 bg-cyan-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <i class="fas ${getActionIcon(action.fields['Action Name'])} text-2xl text-cyan-600"></i>
                        </div>
                        <h3 class="text-xl font-medium text-gray-900 mb-2">Run "${action.fields['Action Name']}"?</h3>
                        <p class="text-gray-600 mb-6">${action.fields['Notes'] || 'This action will process your content.'}</p>
                        
                        <div class="flex justify-center space-x-3">
                            <button id="cancelAction" class="px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
                                Cancel
                            </button>
                            <button id="confirmAction" class="px-4 py-2 bg-cyan-600 text-white rounded-md text-sm font-medium hover:bg-cyan-700">
                                Run Action
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Add event listeners
            document.getElementById('cancelAction').addEventListener('click', () => {
                document.body.removeChild(modal);
            });
            
            document.getElementById('confirmAction').addEventListener('click', async () => {
                document.body.removeChild(modal);
                await triggerAction(contentId, action.id);
            });
        }

        // Event Handlers
        function switchView(view) {
            currentView = view;
            
            // Update navigation buttons
            const navButtons = [
                document.getElementById('navContent'),
                document.getElementById('navActions'),
                document.getElementById('navScheduled'),
                document.getElementById('navPublished')
            ];
            
            navButtons.forEach(btn => {
                btn.classList.remove('border-cyan-500', 'text-cyan-600');
                btn.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
            });
            
            document.getElementById(`nav${view.charAt(0).toUpperCase() + view.slice(1)}`).classList.add('border-cyan-500', 'text-cyan-600');
            document.getElementById(`nav${view.charAt(0).toUpperCase() + view.slice(1)}`).classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
            
            // Hide all content views
            contentListing.classList.add('hidden');
            actionsListing.classList.add('hidden');
            scheduledContent.classList.add('hidden');
            publishedContent.classList.add('hidden');
            
            // Show selected view
            switch (view) {
                case 'content':
                    contentListing.classList.remove('hidden');
                    break;
                case 'actions':
                    actionsListing.classList.remove('hidden');
                    break;
                case 'scheduled':
                    scheduledContent.classList.remove('hidden');
                    renderScheduledContent();
                    break;
                case 'published':
                    publishedContent.classList.remove('hidden');
                    renderPublishedContent();
                    break;
            }
        }

        function openContentDetail(id) {
            selectedContentId = id;
            renderContentDetail(id);
            detailModal.classList.remove('hidden');
        }

        function closeDetailModal() {
            detailModal.classList.add('hidden');
            selectedContentId = null;
        }

        function openCreateContentModal() {
            document.getElementById('modalTitle').textContent = 'Create New Content';
            document.getElementById('recordId').value = '';
            contentForm.reset();
            
            // Set today's date as default publish date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('publishDate').value = today;
            
            contentModal.classList.remove('hidden');
        }

        function openEditContentModal(id) {
            const content = contentItems.find(item => item.id === id);
            if (!content) return;
            
            document.getElementById('modalTitle').textContent = 'Edit Content';
            document.getElementById('recordId').value = content.id;
            
            // Fill the form with content values
            document.getElementById('title').value = content.fields['Title'] || '';
            document.getElementById('description').value = content.fields['Description'] || '';
            document.getElementById('textContent').value = content.fields['Text'] || '';
            document.getElementById('textUrl').value = content.fields['Text URL'] || '';
            document.getElementById('folderUrl').value = content.fields['Folder URL'] || '';
            
            if (content.fields['Publish Date']) {
                const date = new Date(content.fields['Publish Date']);
                document.getElementById('publishDate').value = date.toISOString().split('T')[0];
            } else {
                document.getElementById('publishDate').value = '';
            }
            
            document.getElementById('textStatus').value = content.fields['Text Status'] || 'In-Progress';
            document.getElementById('schedule').checked = content.fields['Schedule'] === true;
            
            contentModal.classList.remove('hidden');
        }

        function closeContentModal() {
            contentModal.classList.add('hidden');
            contentForm.reset();
        }

        function handleEditContent() {
            if (!selectedContentId) return;
            closeDetailModal();
            openEditContentModal(selectedContentId);
        }

        async function handlePublishContent() {
            if (!selectedContentId) return;
            
            const confirmed = confirm('Are you sure you want to publish this content now?');
            if (!confirmed) return;
            
            try {
                await updateContentItem(selectedContentId, {
                    'Published': true
                });
                
                closeDetailModal();
                alert('Content published successfully!');
                
                // Refresh the appropriate view
                if (currentView === 'published') {
                    renderPublishedContent();
                } else if (currentView === 'scheduled') {
                    renderScheduledContent();
                }
            } catch (error) {
                // Error is already handled in updateContentItem function
            }
        }

        async function handleSaveContent(event) {
            event.preventDefault();
            
            const recordId = document.getElementById('recordId').value;
            const fields = {
                'Title': document.getElementById('title').value,
                'Description': document.getElementById('description').value,
                'Text': document.getElementById('textContent').value,
                'Text URL': document.getElementById('textUrl').value,
                'Folder URL': document.getElementById('folderUrl').value,
                'Publish Date': document.getElementById('publishDate').value,
                'Text Status': document.getElementById('textStatus').value,
                'Schedule': document.getElementById('schedule').checked
            };
            
            try {
                if (recordId) {
                    // Update existing content
                    await updateContentItem(recordId, fields);
                    alert('Content updated successfully!');
                } else {
                    // Create new content
                    await createContentItem(fields);
                    alert('Content created successfully!');
                }
                
                closeContentModal();
                
                // Refresh the appropriate view
                if (currentView === 'scheduled' && fields.Schedule) {
                    renderScheduledContent();
                } else if (currentView === 'content') {
                    renderContent();
                }
            } catch (error) {
                // Error is already handled in API functions
            }
        }

        function filterContentItems() {
            const statusValue = statusFilter.value;
            const searchValue = searchInput.value.toLowerCase();
            
            return contentItems.filter(item => {
                // Status filter
                if (statusValue !== 'all' && item.fields['Text Status'] !== statusValue) {
                    return false;
                }
                
                // Search filter
                if (searchValue) {
                    const title = (item.fields['Title'] || '').toLowerCase();
                    const description = (item.fields['Description'] || '').toLowerCase();
                    const id = (item.fields['Content ID'] || '').toLowerCase();
                    
                    return title.includes(searchValue) || 
                           description.includes(searchValue) || 
                           id.includes(searchValue);
                }
                
                return true;
            });
        }

        function filterContent() {
            renderContent();
        }

        // Utility Functions
        function getStatusColor(status) {
            switch (status) {
                case 'In-Progress':
                    return {
                        bg: 'bg-red-100',
                        text: 'text-red-800'
                    };
                case 'Needs Review':
                    return {
                        bg: 'bg-yellow-100',
                        text: 'text-yellow-800'
                    };
                case 'Approved':
                    return {
                        bg: 'bg-green-100',
                        text: 'text-green-800'
                    };
                default:
                    return {
                        bg: 'bg-gray-100',
                        text: 'text-gray-800'
                    };
            }
        }

        function getActionIcon(actionName) {
            const actionName_lower = actionName.toLowerCase();
            if (actionName_lower.includes('publish')) return 'fa-globe';
            if (actionName_lower.includes('post')) return 'fa-paper-plane';
            if (actionName_lower.includes('tweet') || actionName_lower.includes('twitter')) return 'fa-twitter';
            if (actionName_lower.includes('facebook')) return 'fa-facebook';
            if (actionName_lower.includes('linkedin')) return 'fa-linkedin';
            if (actionName_lower.includes('instagram')) return 'fa-instagram';
            if (actionName_lower.includes('email') || actionName_lower.includes('mail')) return 'fa-envelope';
            if (actionName_lower.includes('schedule')) return 'fa-calendar-alt';
            if (actionName_lower.includes('download')) return 'fa-download';
            if (actionName_lower.includes('share')) return 'fa-share-alt';
            return 'fa-bolt'; // Default icon
        }

        function showLoading() {
            loadingSpinner.classList.remove('hidden');
        }
        
        function hideLoading() {
            loadingSpinner.classList.add('hidden');
        }
        
        function showError(message) {
            // Use notification system for errors
            showNotification(message, 'error');
            
            // Also update the error message element for compatibility
            errorText.textContent = message;
            errorMessage.classList.remove('hidden');
            
            // Auto-hide after 5 seconds
            setTimeout(() => {
                errorMessage.classList.add('hidden');
            }, 5000);
        }

        // Initialize
        async function initialize() {
            try {
                await fetchContentItems();
                await fetchActionItems();
                switchView('content');
            } catch (error) {
                showError('Failed to initialize application: ' + error.message);
            }
        }

        // Start the application
        initialize();
    </script>
</body>
</html> 